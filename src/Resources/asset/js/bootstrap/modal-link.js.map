{"version":3,"sources":["modal-link.js"],"names":["$","ModalLink","element","modalSelector","options","modal","iframe","find","extend","modalLink","on","attr","event","stopPropagation","preventDefault","resize","currentTarget","dataset","size","open","href","Phoenix","Modal","height","onload","off","removeClass","addClass","css","setTimeout","contentWindow","document","documentElement","scrollHeight","style","plugin"],"mappings":"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","sourcesContent":["/**\n * Part of earth project.\n *\n * @copyright  Copyright (C) 2020 .\n * @license    __LICENSE__\n */\n\n$(() => {\n  class ModalLink {\n    options = {};\n\n    constructor (\n      element,\n      modalSelector,\n      options = []\n    ) {\n      this.modal = $(modalSelector);\n      this.iframe = this.modal.find('iframe');\n      this.options = $.extend(true, {}, this.options, options);\n\n      this.iframe[0].modalLink = () => {\n        return this;\n      };\n\n      this.modal.on('hide.bs.modal', () => {\n        this.iframe.attr('src', '');\n      });\n\n      element.on('click', (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        let options = {};\n        options.resize = event.currentTarget.dataset.resize;\n        options.size = event.currentTarget.dataset.size;\n\n        options = $.extend(true, {}, this.options, options);\n        this.open(event.currentTarget.href, options);\n      });\n\n      // B/C\n      if (modalSelector === '#phoenix-iframe-modal') {\n        Phoenix.Modal = this;\n      }\n    }\n\n    open(href, options = {}) {\n      options = $.extend(true, {}, this.options, options);\n      let height = '';\n\n      if (options.resize != null) {\n        let onload;\n        this.iframe.on('load', onload = () => {\n          this.resize(this.iframe[0]);\n\n          this.iframe.off('load', onload);\n        });\n      } else if (options.height != null) {\n        height = options.height;\n      }\n\n      if (options.size != null) {\n        this.modal\n          .find('.modal-dialog')\n          .removeClass('modal-lg modal-xl modal-sm modal-xs')\n          .addClass(options.size);\n      }\n\n      this.iframe.css('height', height);\n      this.iframe.attr('src', href);\n      this.modal.modal('show');\n    }\n\n    close() {\n      this.modal.modal('hide');\n      this.iframe.attr('src', '');\n    }\n\n    resize(iframe) {\n      setTimeout(() => {\n        let height = iframe.contentWindow.document.documentElement.scrollHeight;\n\n        if (height < 500) {\n          height = 500;\n        }\n\n        iframe.style.height = height + 'px';\n      }, 30);\n    }\n  }\n\n  Phoenix.plugin('modalLink', ModalLink);\n});\n"],"file":"modal-link.js"}