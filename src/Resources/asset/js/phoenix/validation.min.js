"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){var e={},n=function(t){_inherits(n,PhoenixJQueryPlugin);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,null,[{key:"is",get:function(){return"Validation"}},{key:"pluginName",get:function(){return"validation"}},{key:"pluginClass",get:function(){return i}},{key:"proxies",get:function(){return{validation:"createPlugin"}}}]),n}(),i=function(){function n(e,i,r){_classCallCheck(this,n),this.STATE_SUCCESS="success",this.STATE_FAIL="fail",this.STATE_NONE="none",this.STATE_EMPTY="empty",this.form=e||t,this.phoenix=r,this.options=t.extend(!0,{},this.constructor.defaultOptions,i),this.validators=[],this.handlers={},this.theme={},this.inputs=[],this.form.length&&this.form.attr("novalidate",!0),this.registerDefaultValidators(),this.registerEvents()}return _createClass(n,null,[{key:"defaultOptions",get:function(){return{enabled:!0,events:["change"],scroll:{enabled:!0,offset:-100,duration:1e3}}}}]),_createClass(n,[{key:"getInputs",value:function(){var t=this.form.find("input, select, textarea");return this.inputs.forEach(function(e){return t.add(e)}),t}},{key:"addField",value:function(t){return this.registerInputEvents(t),this.inputs.push(t),this}},{key:"removeField",value:function(t){return this.inputs=this.inputs.filter(function(e,n){return t!==n}),this}},{key:"validateAll",value:function(){var e=this,n=this,i=[],r=n.options.scroll.enabled;return this.form.length&&this.form.addClass("was-validated"),this.getInputs().each(function(o,s){if(!e.validate(s)&&(i.push(s),r)){var a=t(s);a.is(":visible")||(a=a.parents("#"+a.attr("id")+"-control, [data-form-group]")),t("html, body").animate({scrollTop:a.offset().top+n.options.scroll.offset},n.options.scroll.duration),r=!1}}),i.length<=0}},{key:"validate",value:function(e){if(!e)return!0;var n,i=t(e),o=!0;this.showResponse(this.STATE_NONE,i),e.setCustomValidity("");var s=(i.attr("data-validate")||"").split("|");if(""!==i.val()&&s.length)for(var a in s){var u=this.validators[s[a]];if(u&&!u.handler(i.val(),i)){"function"==typeof(n=u.options.notice)&&(n=n(i,this)),e.setCustomValidity(this.phoenix.__("phoenix.message.validation.type.mismatch")),o=!1;break}}if(o&&(o=e.checkValidity(),this.showResponse(this.STATE_SUCCESS,i,n)),o)return!0;var l=e.validity;if(l.valueMissing)return n=i.attr("data-value-missing-message")||this.phoenix.__("phoenix.message.validation.value.missing"),this.phoenix.isDebug()&&console.warn("[Debug] Field: ".concat(i.attr("name")," validity state: value-missing.")),this.showResponse(this.STATE_EMPTY,i,n),!1;for(var f in l)if(!0===l[f]){var c=r(f,"-");n=i.attr("data-"+c+"-message")||this.phoenix.__("phoenix.message.validation."+r(f,".")),this.phoenix.isDebug()&&console.warn("[Debug] Field: ".concat(i.attr("name")," validity state: ").concat(c,"."));break}return this.showResponse(this.STATE_FAIL,i,n),o}},{key:"showResponse",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.phoenix.trigger("validation.response",{state:t,$input:e,help:n,validation:this}),e.trigger({type:"phoenix.validate.input."+t,input:e,state:t,help:n}),this}},{key:"removeResponse",value:function(t){return this.phoenix.trigger("validation.remove",{$element:t}),this}},{key:"addValidator",value:function(t,e,n){return n=n||{},this.validators[t]={handler:e,options:n},this}},{key:"registerEvents",value:function(){var t=this;this.form.on("submit",function(e){return t.options.enabled&&!t.validateAll()?(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),!1):(t.form.trigger("phoenix.validate.success"),!0)}),this.registerInputEvents(this.getInputs())}},{key:"registerInputEvents",value:function(e){var n=this;t.each(this.options.events,function(t,i){e.on(i,function(t){n.validate(t.currentTarget)})})}},{key:"registerDefaultValidators",value:function(){for(var t in e)e.hasOwnProperty(t)&&this.addValidator(t,e[t])}}]),n}();function r(t,e){return t.replace(/([a-z])([A-Z])/g,"$1".concat(e,"$2")).toLowerCase()}e.username=function(t,e){return!new RegExp("[<|>|\"|'|%|;|(|)|&]","i").test(t)},e.numeric=function(t,e){return/^(\d|-)?(\d|,)*\.?\d*$/.test(t)},e.email=function(t,e){t=punycode.toASCII(t);return/^[a-zA-Z0-9.!#$%&â€™*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)},e.url=function(t,e){return/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(t)},e.alnum=function(t,e){return/^[a-zA-Z0-9]*$/.test(t)},e.color=function(t,e){return/^#(?:[0-9a-f]{3}){1,2}$/.test(t)},e.creditcard=function(t,e){return/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6011[0-9]{12}|622((12[6-9]|1[3-9][0-9])|([2-8][0-9][0-9])|(9(([0-1][0-9])|(2[0-5]))))[0-9]{10}|64[4-9][0-9]{13}|65[0-9]{14}|3(?:0[0-5]|[68][0-9])[0-9]{11}|3[47][0-9]{13})*$/.test(t)},e.ip=function(t,e){return/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/.test(t)},e["password-confirm"]=function(e,n){var i=n.attr("data-confirm-target");return t(i).val()===e},window.PhoenixValidation=n}(jQuery);