"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}$(function(){Phoenix.plugin("repeatable",function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,e),this.$element=t,this.$wrapper=t.closest(".phoenix-repeatable"),this.$body=this.$wrapper.find("table tbody"),this.tmpl=_.template(this.$wrapper.find(".repeatable-item-tmpl").html()),this.options=n,this.fields=i,this.items=a,0===this.items.length&&this.items.push(this.getEmptyItem()),this.bindEvents(),this.render()}return _createClass(e,[{key:"bindEvents",value:function(){var e=this;this.$body.on("click",'[data-task="repeatable.add"]',function(t){var i=$(t.currentTarget).closest("[data-repeatable-item]"),a=e.getItemHtml(e.getEmptyItem());i.after(a),a.hide(),a.fadeIn()}),this.$body.on("click",'[data-task="repeatable.delete"]',function(t){var i=$(t.currentTarget).closest("[data-repeatable-item]");i.fadeOut(400,function(){i.remove(),e.toggleRequired(),e.getItems().length||e.addItem(e.getEmptyItem())})})}},{key:"render",value:function(){var e=this;this.items.forEach(function(t){var i=$(e.tmpl(t));e.$body.append(i)})}},{key:"prepareItem",value:function(e){e.find('[data-task="repeatable.add"]').on("click",function(){})}},{key:"addItem",value:function(e){this.$body.append(this.getItemHtml(e))}},{key:"getItemHtml",value:function(e){var t=$(this.tmpl(e));return this.prepareItem(t),t}},{key:"getEmptyItem",value:function(){var e={};return this.fields.forEach(function(t){e[t]=""}),e.i=Phoenix.uniqid(),e}},{key:"getItems",value:function(){return this.$body.find("[data-repeatable-item]")}},{key:"toggleRequired",value:function(){}}]),e}())});