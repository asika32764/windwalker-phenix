"use strict";var _get=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){var t=function(){function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.options=e.extend(!0,{},this.constructor.defaultOptions,r),this._listeners={},this.waits=[],this.wait(function(t){e(function(){return t()})}),e(function(){n.completed().then(function(){return n.trigger("loaded")})})}return _createClass(t,null,[{key:"defaultOptions",get:function(){return{}}}]),_createClass(t,[{key:"use",value:function(e){var t=this;if(Array.isArray(e))return e.forEach(function(e){return t.use(e)}),this;if(void 0===e.is)throw new Error("Plugin: "+e.name+" must instance of : "+PhoenixPlugin.name);var n=e.install(this);return n.boot(this),this.trigger("plugin.installed",n),this}},{key:"detach",value:function(e){if(!e instanceof PhoenixPlugin)throw new Error("Plugin must instance of : "+PhoenixPlugin.name);return e.uninstall(this),this.trigger("plugin.uninstalled",e),this}},{key:"on",value:function(e,t){return void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t),this}},{key:"off",value:function(e){return delete this._listeners[e],this}},{key:"trigger",value:function(e,t){var n=[];return this.listeners(e).forEach(function(e){n.push(e(t))}),n}},{key:"listeners",value:function(e){return void 0===this._listeners[e]?[]:this._listeners[e]}},{key:"data",value:function(t,n){return void 0===n?e(document).data(t):(e(document).data(t,n),this)}},{key:"removeData",value:function(t){return e(document).removeData(t),this}},{key:"uri",value:function(e){return this.data("phoenix.uri")[e]}},{key:"asset",value:function(e){return this.uri("asset")[e]}},{key:"wait",value:function(t){var n=e.Deferred();return this.waits.push(n),t(function(){return n.resolve()}),n}},{key:"completed",value:function(){var t=e.when.apply(e,_toConsumableArray(this.waits));return this.waits=[],t}},{key:"plugin",value:function(t,n){var r=this;return e.fn[t]=function(){if(!this.data("phoenix."+t)){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];var a=new(Function.prototype.bind.apply(n,[null].concat([this],i)));this.data("phoenix."+t,a),r.trigger("jquery.plugin.created",{name:t,ele:this,instance:a})}var s=this.data("phoenix."+t);return r.trigger("jquery.plugin.get",{name:t,ele:this,instance:s}),s},this}}]),t}();window.PhoenixCore=t}(jQuery),function(e){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"options",get:function(){return this.phoenix.options[this.constructor.is.toLowerCase()]}}],[{key:"install",value:function(e){var t=new this;return this.createProxies(e,t),t}},{key:"uninstall",value:function(e){var t=new this(e);this.resetProxies(e,t)}},{key:"is",get:function(){throw new Error('Please add "is" property to Phoenix Plugin: '+this.name)}},{key:"proxies",get:function(){return{}}},{key:"defaultOptions",get:function(){return{}}}]),_createClass(t,[{key:"boot",value:function(t){var n=this;this.phoenix=t;var r=this.constructor.is.toLowerCase();this.phoenix.options[r]=e.extend(!0,{},this.constructor.defaultOptions,this.phoenix.options[r]),this.created(),e(function(){return n.ready()}),this.phoenix.on("loaded",this.loaded)}},{key:"created",value:function(){}},{key:"ready",value:function(){}},{key:"loaded",value:function(){}}],[{key:"createProxies",value:function(e,t){if(void 0===t.constructor.proxies)return this;this.resetProxies(e,t),e[t.constructor.is]=t;var n=t.constructor.proxies,r=function(r){if(!n.hasOwnProperty(r))return"continue";var i=n[r];if(void 0!==e[r])throw new Error("Property: "+r+" has exists in Phoenix instance.");if("function"==typeof i)e[r]=i;else{if(void 0===t[i])throw new Error('Proxy property: "'+i+'" not found in Plugin: '+t.constructor.name);"function"==typeof t[i]?e[r]=function(){return t[i].apply(t,arguments)}:Object.defineProperties(e,r,{get:function(){return t[i]},set:function(e){t[i]=e}})}};for(var i in n)r(i)}},{key:"resetProxies",value:function(e,t){var n="string"==typeof t?t:t.constructor.is;if(e[n]&&(t=e[n]),void 0!==t.constructor.proxies){for(var r in t.constructor.proxies)delete e[r];delete e[t.constructor.is]}}}]),t}(),n=function(n){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return _inherits(r,t),_createClass(r,[{key:"createPlugin",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.mainSelector=t;for(var i=arguments.length,o=Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return(n=e(t))[this.constructor.pluginName].apply(n,[r,this.phoenix].concat(o))}}],[{key:"install",value:function(e){var t=_get(r.__proto__||Object.getPrototypeOf(r),"install",this).call(this,e);return e.plugin(this.pluginName,this.pluginClass),t}},{key:"pluginName",get:function(){throw new Error("Please provide a plugin name.")}},{key:"pluginClass",get:function(){throw new Error("Please provide a class as plugin instance.")}}]),r}();window.PhoenixPlugin=t,window.PhoenixJQueryPlugin=n}(jQuery),function(e){var t=function(t){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.aliveHandle=null,e}return _inherits(n,PhoenixPlugin),_createClass(n,null,[{key:"is",get:function(){return"Helper"}},{key:"proxies",get:function(){return{confirm:"confirm",keepAlive:"keepAlive",stopKeepAlive:"stopKeepAlive",loadScript:"loadScript"}}},{key:"defaultOptions",get:function(){return{}}}]),_createClass(n,[{key:"confirm",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){e=e||"Are you sure?";var n=confirm(e);return t(n),n})},{key:"loadScript",value:function(t){var n=this;"string"==typeof t&&(t=[t]);var r=[],i={};return i[this.phoenix.asset("version")]="1",t.forEach(function(t){r.push(e.getScript({url:n.addUriBase(t),cache:!0,data:i}))}),e.when.apply(e,r)}},{key:"addUriBase",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"path";return"/"===e.substr(0,2)||"http"===e.substr(0,4)?e:this.phoenix.asset(t)+"/"+e}},{key:"keepAlive",value:function(t,n){return this.aliveHandle=window.setInterval(function(){return e.get("/")},n)}},{key:"stopKeepAlive",value:function(){clearInterval(this.aliveHandle)}}]),n}();window.PhoenixHelper=t}(jQuery),function(e){var t=function(t){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.aliveHandle=null,e}return _inherits(n,PhoenixPlugin),_createClass(n,null,[{key:"is",get:function(){return"UI"}},{key:"defaultOptions",get:function(){return{messageSelector:".message-wrap"}}},{key:"proxies",get:function(){return{addMessage:"renderMessage"}}}]),_createClass(n,[{key:"ready",value:function(){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"ready",this).call(this),this.messageContainer=e(this.options.messageSelector)}},{key:"showValidateResponse",value:function(e,t,n,r){throw new Error("Please implement this method.")}},{key:"addValidateResponse",value:function(e,t,n,r,i){throw new Error("Please implement this method.")}},{key:"removeValidateResponse",value:function(e){throw new Error("Please implement this method.")}},{key:"renderMessage",value:function(e,t){throw new Error("Please implement this method.")}},{key:"removeMessages",value:function(){throw new Error("Please implement this method.")}},{key:"toggleFilter",value:function(e,t){var n=t.attr("data-class-show")||"btn-primary",r=t.attr("data-class-hide")||"btn-default",i=t.find("span.filter-button-icon"),o=i.attr("data-class-show")||"fa fa-angle-up",a=i.attr("data-class-hide")||"fa fa-angle-down";e.hasClass("shown")?(t.removeClass(n).addClass(r),e.hide("fast"),e.removeClass("shown"),i.removeClass(o).addClass(a)):(t.removeClass(r).addClass(n),e.show("fast"),e.addClass("shown"),i.removeClass(a).addClass(o))}},{key:"confirm",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){e=e||"Are you sure?";var n=confirm(e);return t(n),n})},{key:"keepAlive",value:function(t,n){return this.aliveHandle=window.setInterval(function(){return e.get("/")},n)}},{key:"stopKeepAlive",value:function(){clearInterval(this.aliveHandle)}}]),n}();window.PhoenixUI=t}(jQuery),function(e){var t=function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,PhoenixPlugin),_createClass(n,[{key:"ready",value:function(){var t=this;e(window).on("popstate",function(e){return t.phoenix.on("router.popstate",e)})}},{key:"add",value:function(e,t){var n={};return n[e]=t,this.phoenix.data("phoenix.routes",n),this}},{key:"route",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.phoenix.data("phoenix.routes")[e];if(void 0===n)throw new Error('Route: "'+e+'" not found');return this.addQuery(n,t)}},{key:"addQuery",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===n?t:(n=e.param(n),t+(/\?/.test(t)?"&"+n:"?"+n))}},{key:"push",value:function(e){return"string"==typeof e&&(e={uri:e}),window.history.pushState(e.state||null,e.title||null,e.uri||this.route(e.route,e.params)),this}},{key:"replace",value:function(e){return"string"==typeof e&&(e={uri:e}),window.history.replaceState(e.state||null,e.title||null,e.uri||this.route(e.route,e.params)),this}},{key:"state",value:function(){return window.history.state}},{key:"back",value:function(){window.history.back()}},{key:"forward",value:function(){window.history.forward()}},{key:"go",value:function(e){window.history.go(e)}}],[{key:"is",get:function(){return"Router"}},{key:"proxies",get:function(){return{addRoute:"add",route:"route"}}}]),n}();window.PhoenixRouter=t}(jQuery),function(){var e=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.keys={},e}return _inherits(t,PhoenixPlugin),_createClass(t,null,[{key:"is",get:function(){return"Translator"}},{key:"proxies",get:function(){return{trans:"translate",__:"translate",addLanguage:"addKey"}}}]),_createClass(t,[{key:"translate",value:function(e){for(var t=this.normalize(e),n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(r.length)return this.sprintf.apply(this,[e].concat(r));var o=this.phoenix.data("phoenix.languages");return o[t]?o[t]:e}},{key:"sprintf",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n[0]=this.translate(e),sprintf.apply(sprintf,n)})},{key:"addKey",value:function(e,t){var n={};return n[this.normalize(e)]=t,this.phoenix.data("phoenix.languages",n),this}},{key:"normalize",value:function(e){return e.replace(/[^A-Z0-9]+/gi,".")}}]),t}();window.PhoenixTranslator=e}(),function(){var e=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,PhoenixPlugin),_createClass(t,[{key:"created",value:function(){var e=this,t=this.phoenix;t.Theme=t.UI;var n=!1,r=!1;t.on("jquery.plugin.created",function(i){n||"form"!==i.name||(["delete","get","patch","post","put","sendDelete","submit"].forEach(function(n){t[n]=function(){var t;e.constructor.warn("Phoenix",n),(t=i.instance)[n].apply(t,arguments)}}),n=!0),r||"grid"!==i.name||(["toggleFilter","sort","checkRow","updateRow","doTask","batch","copyRow","deleteList","deleteRow","toggleAll","countChecked","getChecked","hasChecked","reorderAll","reorder"].forEach(function(n){t.Grid[n]=function(){var t;e.constructor.warn("Phoenix.Grid",n),(t=i.instance)[n].apply(t,arguments)}}),r=!0)})}},{key:"ready",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this)}}],[{key:"warn",value:function(e,t){console.warn("Calling "+e+"."+t+"() is deprecated.")}},{key:"is",get:function(){return"Legacy"}}]),t}();window.PhoenixLegacy=e}();