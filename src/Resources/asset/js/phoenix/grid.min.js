!function(t){"use strict";var e="grid",n={selector:{search:{container:".search-container",button:".search-button",clearButton:".search-clear-button"},filter:{container:".filter-container",button:".filter-toggle-button"},sort:{button:"a[data-sort-button]"}}};function i(e,i,r){this.form=e,this.core=i,this.options=t.extend(!0,{},n,r);var o=this.options.selector;this.searchContainer=this.form.find(o.search.container),this.searchButton=this.form.find(o.search.button),this.searchClearButton=this.form.find(o.search.clearButton),this.filterContainer=this.form.find(o.filter.container),this.filterButton=this.form.find(o.filter.button),this.sortButtons=this.form.find(o.sort.button),this.registerEvents()}i.prototype={registerEvents:function(){var t=this;this.searchClearButton.click(function(e){t.searchContainer.find("input, textarea, select").val(""),t.filterContainer.find("input, textarea, select").val(""),t.form.submit()}),this.filterButton.click(function(e){t.toggleFilter(),e.stopPropagation(),e.preventDefault()}),this.sortButtons.click(function(e){t.sort(this,e)})},toggleFilter:function(){return Phoenix.Theme.toggleFilter(this.filterContainer,this.filterButton),this},sort:function(e,n){var i=this.form.find("input[name=list_ordering]");i.length||(i=t('<input name="list_ordering" type="hidden" value="" />'),this.form.append(i));var r=this.form.find("input[name=list_direction]");return r.length||(r=t('<input name="list_direction" type="hidden" value="" />'),this.form.append(r)),i.val(e),r.val(n),this.core.put()},checkRow:function(t,e){e=e||!0;var n=this.form.find("input.grid-checkbox[data-row-number="+t+"]");if(!n.length)throw new Error("Checkbox of row: "+t+" not found.");n[0].checked=e},updateRow:function(t,e,n){return this.toggleAll(!1),this.checkRow(t),this.core.patch(e,n)},doTask:function(t,e,n,i){return(i=i||{}).task=t,this.updateRow(e,n,i)},batch:function(t,e,n){return(n=n||{}).task=t,this.core.patch(e,n)},copyRow:function(t,e,n){return this.toggleAll(!1),this.checkRow(t),this.core.post(e,n)},deleteList:function(t,e,n){var i=this;return t=t||Phoenix.Translator.translate("phoenix.message.delete.confirm"),this.core.confirm(t,function(t){t&&i.core.delete(e,n)}),!0},deleteRow:function(t,e,n,i){return this.toggleAll(!1),this.checkRow(t),this.deleteList(e,n,i)},toggleAll:function(e,n){var i=this.form.find("input.grid-checkbox[type=checkbox]");return t.each(i,function(t,r){n?setTimeout(function(){r.checked=e},n/i.length*t):r.checked=e}),this},countChecked:function(){return this.getChecked().length},getChecked:function(){var e=this.form.find("input.grid-checkbox[type=checkbox]"),n=[];return t.each(e,function(t,e){e.checked&&n.push(e)}),n},hasChecked:function(t,e){if(t=t||Phoenix.Translator.translate("phoenix.message.grid.checked"),!this.countChecked())throw alert(t),e&&(e.stopPropagation(),e.preventDefault()),new Error(t);return this},reorderAll:function(e,n){var i=this,r=this.form.find("input[name=origin_ordering]");if(r.length){var o=r.val().split(","),h=this.form.find(".ordering-control input");this.toggleAll(!1),h.each(function(e){var n=t(this);if(n.val()!==o[e]){i.checkRow(n.data("order-row"));var r=n.parents("tr"),h=r.data("order-group");""!==h&&r.siblings("[data-order-group="+h+"]").find("input.grid-checkbox").prop("checked",!0)}})}return this.batch("reorder",e,n)},reorder:function(t,e,n,i){return(i=i||{}).delta=e,this.doTask("reorder",t,n,i)}},t.fn[e]=function(t,n){return this.data("phoenix."+e)||this.data("phoenix."+e,new i(this,t,n)),this.data("phoenix."+e)}}(jQuery);
//# sourceMappingURL=grid.min.js.map
