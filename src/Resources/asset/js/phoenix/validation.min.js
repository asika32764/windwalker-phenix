!function(t){"use strict";var e="validation",i={},s={events:["change"],scroll:{enabled:!0,offset:-100,duration:1e3}},n=function(e,i){i=t.extend({},s,i),this.STATE_SUCCESS="success",this.STATE_FAIL="fail",this.STATE_NONE="none",this.STATE_EMPTY="empty",this.form=e||t,this.options=i,this.validators=[],this.theme={},this.inputs=this.form.find("input, select, textarea, div.input-list-container"),this.registerDefaultValidators(),this.registerEvents()};n.prototype={addField:function(t){return this.inputs=this.inputs.add(t),this},validateAll:function(){var e=this,i=[],s=e.options.scroll.enabled;return this.inputs.each(function(n){if(!e.validate(this)&&(i.push(this),s)){var o=t(this);o.is(":visible")||(o=o.parents("#"+o.attr("id")+"-control")),t("html, body").animate({scrollTop:o.offset().top+e.options.scroll.offset},e.options.scroll.duration),s=!1}}),i.length<=0},validate:function(e){var i,s,n=t(e);if(n.attr("disabled"))return this.showResponse(this.STATE_NONE,n),!0;if("radio"==n.attr("type")||"checkbox"==n.attr("type"))return!0;if(n.attr("required")||n.hasClass("required"))if("div"===n.prop("tagName").toLowerCase()&&n.hasClass("input-list-container")){if(!n.find("input:checked").length)return this.showResponse(this.STATE_EMPTY,n),!1}else if(!n.val()||"checkbox"===n.attr("type")&&!n.is(":checked"))return this.showResponse(this.STATE_EMPTY,n),!1;if((i=n.attr("class"))&&(s=i.match(/validate-([a-zA-Z0-9\_|-]+)/)),!n.val()||!s)return this.showResponse(this.STATE_NONE,n),!0;if(!(s=this.validators[s[1]])||!s.handler)return this.showResponse(this.STATE_NONE,n),!0;if(!s.handler(n.val(),n)){var o=s.options.notice;return"function"==typeof o&&(o=o(n,this)),this.showResponse(this.STATE_FAIL,n,o),!1}return this.showResponse(this.STATE_SUCCESS,n),!0},showResponse:function(t,e,i){return Phoenix.Theme.showValidateResponse(this,t,e,i),e.trigger({type:"phoenix.validate."+t,input:e,state:t,help:i}),this},removeResponse:function(t){return Phoenix.Theme.removeValidateResponse(t),this},addValidator:function(t,e,i){return i=i||{},this.validators[t]={handler:e,options:i},this},registerEvents:function(){var e=this;this.form.on("submit",function(t){return!!e.validateAll()||(t.stopPropagation(),t.preventDefault(),!1)}),t.each(this.options.events,function(){e.inputs.on(this,function(){e.validate(this)})})},registerDefaultValidators:function(){var e=this;t.each(i,function(t){e.addValidator(t,this)})}},t.fn[e]=function(t){return this.data("phoenix."+e)||this.data("phoenix."+e,new n(this,t)),this.data("phoenix."+e)},i.username=function(t,e){return!new RegExp("[<|>|\"|'|%|;|(|)|&]","i").test(t)},i.password=function(t,e){return/^\S[\S ]{2,98}\S$/.test(t)},i.numeric=function(t,e){return/^(\d|-)?(\d|,)*\.?\d*$/.test(t)},i.email=function(t,e){t=punycode.toASCII(t);return/^[a-zA-Z0-9.!#$%&â€™*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)},i.url=function(t,e){t=punycode.toASCII(t);return/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(t)},i.alnum=function(t,e){return/^[a-zA-Z0-9]*$/.test(t)},i.color=function(t,e){return/^#(?:[0-9a-f]{3}){1,2}$/.test(t)},i.creditcard=function(t,e){return/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6011[0-9]{12}|622((12[6-9]|1[3-9][0-9])|([2-8][0-9][0-9])|(9(([0-1][0-9])|(2[0-5]))))[0-9]{10}|64[4-9][0-9]{13}|65[0-9]{14}|3(?:0[0-5]|[68][0-9])[0-9]{11}|3[47][0-9]{13})*$/.test(t)},i.ip=function(t,e){return/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/.test(t)}}(jQuery);