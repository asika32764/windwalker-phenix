{"version":3,"sources":["modal-link.js"],"names":["$","ModalLink","element","modalSelector","options","self","modal","iframe","find","extend","on","attr","event","stopPropagation","preventDefault","resize","currentTarget","dataset","size","console","log","open","href","onload","off","removeClass","addClass","css","height","contentWindow","document","documentElement","scrollHeight","style","Phoenix","plugin"],"mappings":"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","sourcesContent":["/**\n * Part of earth project.\n *\n * @copyright  Copyright (C) 2020 .\n * @license    __LICENSE__\n */\n\n$(() => {\n  class ModalLink {\n    options = {};\n\n    constructor (\n      element,\n      modalSelector,\n      options = []\n    ) {\n      const self = this;\n      this.modal = $(modalSelector);\n      this.iframe = this.modal.find('iframe');\n\n      this.options = $.extend(true, {}, this.options, options);\n\n      this.modal.on('hide.bs.modal', () => {\n        self.iframe.attr('src', '');\n      });\n\n      element.on('click', (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        let options = {};\n        options.resize = event.currentTarget.dataset.resize;\n        options.size = event.currentTarget.dataset.size;\n\n        options = $.extend(true, {}, this.options, options);\n        console.log(options, this.options);\n        this.open(event.currentTarget.href, options);\n      });\n    }\n\n    open(href, options = {}) {\n      if (options.resize != null) {\n        let onload;\n        this.iframe.on('load', onload = () => {\n          this.resize(this.iframe[0]);\n\n          this.iframe.off('load', onload);\n        });\n      }\n\n      if (options.size != null) {\n        this.modal\n          .find('.modal-dialog')\n          .removeClass('modal-lg modal-xl modal-sm modal-xs')\n          .addClass(options.size);\n      }\n\n      this.iframe.css('height', '');\n      this.iframe.attr('src', href);\n      this.modal.modal('show');\n    }\n\n    close() {\n      this.modal.modal('hide');\n      this.iframe.attr('src', '');\n    }\n\n    resize(iframe) {\n      const height = iframe.contentWindow.document.documentElement.scrollHeight;\n\n      if (height < 500) {\n        return;\n      }\n\n      iframe.style.height = height + 'px';\n    }\n  }\n\n  Phoenix.plugin('modalLink', ModalLink);\n});\n"],"file":"modal-link.js"}