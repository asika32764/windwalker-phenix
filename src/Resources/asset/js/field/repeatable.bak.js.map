{"version":3,"sources":["repeatable.bak.js"],"names":["$","Phoenix","plugin","$element","fields","items","options","$wrapper","closest","$body","find","tmpl","_","template","html","length","push","getEmptyItem","bindEvents","render","on","e","current","currentTarget","row","getItemHtml","after","hide","fadeIn","item","fadeOut","remove","toggleRequired","getItems","addItem","forEach","append","$elements","prepareItem","key","i","uniqid"],"mappings":"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","sourcesContent":["/**\n * Part of phoenix project.\n *\n * @copyright  Copyright (C) 2019 ${ORGANIZATION}.\n * @license    __LICENSE__\n */\n\n$(() => {\n  Phoenix.plugin('repeatable', class RepeatableField {\n    constructor($element, fields = [], items = [], options = {}) {\n      this.$element = $element;\n      this.$wrapper = $element.closest('.phoenix-repeatable');\n      this.$body = this.$wrapper.find('table tbody');\n      this.tmpl = _.template(this.$wrapper.find('.repeatable-item-tmpl').html());\n      this.options = options;\n      this.fields = fields;\n      this.items = items;\n\n      if (this.items.length === 0) {\n        this.items.push(this.getEmptyItem());\n      }\n\n      this.bindEvents();\n\n      this.render();\n    }\n\n    bindEvents() {\n      this.$body.on('click', '[data-task=\"repeatable.add\"]', (e) => {\n        const current = $(e.currentTarget).closest('[data-repeatable-item]');\n\n        const row = this.getItemHtml(this.getEmptyItem());\n        current.after(row);\n\n        row.hide();\n        row.fadeIn();\n      });\n\n      this.$body.on('click', '[data-task=\"repeatable.delete\"]', (e) => {\n        const item = $(e.currentTarget).closest('[data-repeatable-item]');\n\n        item.fadeOut(400, () => {\n          item.remove();\n          this.toggleRequired();\n\n          if (!this.getItems().length) {\n            this.addItem(this.getEmptyItem());\n          }\n        });\n      });\n    }\n\n    render() {\n      this.items.forEach((item) => {\n        const row = $(this.tmpl(item));\n\n        this.$body.append(row);\n      });\n    }\n\n    prepareItem($elements) {\n      $elements.find('[data-task=\"repeatable.add\"]').on('click', () => {\n\n      });\n    }\n\n    addItem(item) {\n      this.$body.append(this.getItemHtml(item));\n    }\n\n    getItemHtml(item) {\n      const row = $(this.tmpl(item));\n\n      this.prepareItem(row);\n\n      return row;\n    }\n\n    getEmptyItem() {\n      const item = {};\n\n      this.fields.forEach(key => {\n        item[key] = '';\n      });\n\n      item.i = Phoenix.uniqid();\n\n      return item;\n    }\n\n    getItems() {\n      return this.$body.find('[data-repeatable-item]');\n    }\n\n    toggleRequired() {\n      //\n    }\n  })\n});\n"],"file":"repeatable.bak.js"}