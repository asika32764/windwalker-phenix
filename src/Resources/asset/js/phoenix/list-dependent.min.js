!function(t){"use strict";var e="listDependent",i=function(t,e,i){},n={ajax:{url:null,value_field:"value"},source:null,text_field:"title",value_field:"id",first_option:null,default_value:null,initial_load:!0,empty_mark:"__EMPTY__",hooks:{before_request:i,after_request:i}},s=function(e,i,s){this.element=e,this.options=t.extend(!0,{},n,s),this.dependent=t(i),this.bindEvents(),this.options.initial_load&&this.changeList(this.dependent.val(),!0)};s.prototype={bindEvents:function(){var e=this;this.dependent.on("change",function(i){var n=t(this);e.changeList(n.val())})},changeList:function(t,e){""===(t=t||this.dependent.val())&&(t=this.options.empty_mark),this.options.ajax.url?this.ajaxUpdate(t):this.options.source&&this.sourceUpdate(t,e)},sourceUpdate:function(t,e){var i=this.options.source;this.beforeHook(t,this.element,this.dependent),i[t]?this.updateListElements(i[t]):(this.updateListElements([]),e||""===t||0===parseInt(t)||console.log("List for value: "+t+" not found.")),this.afterHook(t,this.element,this.dependent)},ajaxUpdate:function(e){var i=this,n=new SimpleURI(this.options.ajax.url);n.setVar(this.options.ajax.value_field,e),i.beforeHook(e,i.element,i.dependent),t.get(n.toString()).done(function(t){t.success?i.updateListElements(t.data):console.error(t.message)}).fail(function(t){console.error(t.message)}).always(function(){i.afterHook(e,i.element,i.dependent)})},updateListElements:function(e){var i=this,n=this.options.text_field,s=this.options.value_field;i.element.empty(),this.options.first_option&&(e.unshift({}),e[0][n]=this.options.first_option[n],e[0][s]=this.options.first_option[s]),t.each(e,function(){var e=this[s],o=t("<option>"+this[n]+"</option>");o.attr("value",e),this.attributes&&t.each(this.attributes,function(t){o.attr(t,this)}),i.options.default_value==e&&o.attr("selected","selected"),i.element.append(o)}),i.element.trigger("chosen:updated"),i.element.trigger("change")},beforeHook:function(t,e,i){return this.options.hooks.before_request.call(this,t,e,i)},afterHook:function(t,e,i){return this.options.hooks.after_request.call(this,t,e,i)}},t.fn[e]=function(i,n){return t.data(this,"phoenix."+e)||t.data(this,"phoenix."+e,new s(this,i,n)),t.data(this,"phoenix."+e)}}(jQuery);