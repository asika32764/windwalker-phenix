"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}$(function(){window.Phoenix=window.Phoenix||{},window.Phoenix.Field=window.Phoenix.Field||{},window.Phoenix.Field.Modal={elements:{},select:function(e,t,i){var a=$(e);"object"!==_typeof(t)&&(t={value:t,title:i}),a.find(".input-group input").attr("value",t.title).trigger("change").delay(250).effect("highlight"),a.find("input[data-value-store]").attr("value",t.value).trigger("change"),a.find(".modal-field-image-preview").css("background-image","url(".concat(t.image,")")),$("#phoenix-iframe-modal").modal("hide")},selectAsTag:function(e,t,i){var a=$(e).find("[data-value-store]");"object"!==_typeof(t)&&(t={value:t,title:i});var n=a.find("option[value='".concat(t.value,"']"));if(n.length)n.is(":checked")?alert(Phoenix.__("phoenix.form.field.modal.already.selected")):(n.prop("selected",!0).trigger("change"),$("#phoenix-iframe-modal").modal("hide"));else{var o=new Option(t.title,t.value,!0,!0);a.append(o).trigger("change"),$("#phoenix-iframe-modal").modal("hide")}},selectAsList:function(e,t,i){var a=$(e),n=a.data("modal-list");"object"!==_typeof(t)&&(t={value:t,title:i}),0===a.find("[data-value='".concat(t.value,"']")).length?(n.append(t,!0),$("#phoenix-iframe-modal").modal("hide")):alert(Phoenix.__("phoenix.form.field.modal.already.selected"))}},window.Phoenix.Field.ModalList=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.$ele=$(t),this.options=a,this.items=i,this.template=underscore.template($(this.options.itemTemplate).html()),this.render(),this.$ele.data("modal-list",this)}return _createClass(e,[{key:"render",value:function(){var e=this;this.items.forEach(function(t){e.append(t)})}},{key:"append",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.$ele.find(".modal-list-container"),n=$(this.template(e));n.attr("data-value",e.value),n.find(".modal-list-item-delete button").on("click",function(e){var i=$(e.currentTarget).parents(".list-group-item");i.slideUp(400,function(){i.remove(),t.toggleRequired()})}),a.append(n),this.toggleRequired(),i&&n.effect("highlight")}},{key:"toggleRequired",value:function(){var e=this.$ele.find("[data-value-store]");this.$ele.find("[data-validation-placeholder]").attr("disabled",0!==e.length)}},{key:"open",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.$ele.attr("data-max-items");t&&$(".modal-list-container .list-group-item").length>=t?alert(Phoenix.__("phoenix.form.field.modal.max.selected",t)):Phoenix.Modal.open($(e.currentTarget).attr("href"))}}]),e}()});