{"version":3,"sources":["modal-link.js"],"names":["$","ModalLink","element","modalSelector","options","modal","iframe","find","extend","modalLink","on","attr","event","stopPropagation","preventDefault","resize","currentTarget","dataset","size","open","href","Phoenix","Modal","onload","off","removeClass","addClass","css","height","contentWindow","document","documentElement","scrollHeight","style","plugin"],"mappings":"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","sourcesContent":["/**\n * Part of earth project.\n *\n * @copyright  Copyright (C) 2020 .\n * @license    __LICENSE__\n */\n\n$(() => {\n  class ModalLink {\n    options = {};\n\n    constructor (\n      element,\n      modalSelector,\n      options = []\n    ) {\n      this.modal = $(modalSelector);\n      this.iframe = this.modal.find('iframe');\n      this.options = $.extend(true, {}, this.options, options);\n\n      this.iframe[0].modalLink = () => {\n        return this;\n      };\n\n      this.modal.on('hide.bs.modal', () => {\n        this.iframe.attr('src', '');\n      });\n\n      element.on('click', (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        let options = {};\n        options.resize = event.currentTarget.dataset.resize;\n        options.size = event.currentTarget.dataset.size;\n\n        options = $.extend(true, {}, this.options, options);\n        this.open(event.currentTarget.href, options);\n      });\n\n      // B/C\n      if (modalSelector === '#phoenix-iframe-modal') {\n        Phoenix.Modal = this;\n      }\n    }\n\n    open(href, options = {}) {\n      if (options.resize != null) {\n        let onload;\n        this.iframe.on('load', onload = () => {\n          this.resize(this.iframe[0]);\n\n          this.iframe.off('load', onload);\n        });\n      }\n\n      if (options.size != null) {\n        this.modal\n          .find('.modal-dialog')\n          .removeClass('modal-lg modal-xl modal-sm modal-xs')\n          .addClass(options.size);\n      }\n\n      this.iframe.css('height', '');\n      this.iframe.attr('src', href);\n      this.modal.modal('show');\n    }\n\n    close() {\n      this.modal.modal('hide');\n      this.iframe.attr('src', '');\n    }\n\n    resize(iframe) {\n      const height = iframe.contentWindow.document.documentElement.scrollHeight;\n\n      if (height < 500) {\n        return;\n      }\n\n      iframe.style.height = height + 'px';\n    }\n  }\n\n  Phoenix.plugin('modalLink', ModalLink);\n});\n"],"file":"modal-link.js"}